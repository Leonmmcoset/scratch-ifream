module.exports=function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=7)}([function(e,t){e.exports=flarum.core.compat.app},function(e,t){e.exports=flarum.core.compat["common/components"]},function(e,t){e.exports=flarum.core.compat["core/extend"]},function(e,t){e.exports=flarum.core.compat["forum/components/ComposerBody"]},function(e,t){e.exports=flarum.core.compat["common/components/Button"]},,,function(e,t,o){"use strict";o.r(t);var r=o(2),n=o(0),a=o.n(n),u=o(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function s(e,t,o){return t=y(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,o||[],y(e).constructor):t.apply(e,o))}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,o){var r=b(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:o):n.value}}).apply(null,arguments)}function b(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(){return c(this,t),s(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),function(e,t,o){return t&&f(e.prototype,t),o&&f(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"oninit",value:function(e){var o,r,n,a,u;(o=t,r="oninit",n=this,u=p(y(1&(a=3)?o.prototype:o),r,n),2&a&&"function"==typeof u?function(e){return u.apply(n,e)}:u)([e]),this.url=m.prop(""),console.log("[Iframe扩展] 模态框初始化")}},{key:"content",value:function(){return console.log("[Iframe扩展] 渲染模态框内容"),m("div",{className:"Modal-body"},m("p",null,app.translator.trans("flarum-iframe.forum.modal.instructions")),m(u.TextField,{className:"FormControl",bidi:this.url,placeholder:app.translator.trans("flarum-iframe.forum.modal.placeholder")}),m("div",{className:"Form-actions"},m("button",{type:"button",className:"Button Button--primary",onclick:this.embedIframe.bind(this)},app.translator.trans("flarum-iframe.forum.modal.submit_button"))))}},{key:"embedIframe",value:function(){var e=this.url();if(e){console.log("[Iframe扩展] 开始嵌入IFRAME，URL:",e);var t=app.composer,o=t.body(),r="https://run.scdev.top/?url=".concat(encodeURIComponent(e)),n="[iframe]".concat(r,"[/iframe]");console.log("[Iframe扩展] 插入代码:",n),t.body(o+"\n\n"+n),app.modal.close()}}}])}(u.Modal),g=o(3),h=o.n(g),O=o(4),j=o.n(O);a.a.initializers.add("leonmmcoset-iframe",(function(){console.log("[Iframe扩展] 初始化开始"),Object(r.extend)(h.a.prototype,"toolbarItems",(function(e){console.log("[Iframe扩展] 用户登录状态:",a.a.user?"已登录":"未登录"),a.a.user&&(console.log("[Iframe扩展] 用户权限列表:",a.a.user.permissions()),console.log("[Iframe扩展] 检查权限: forum.iframe.embed",a.a.user.hasPermission("forum.iframe.embed"))),a.a.user&&a.a.user.hasPermission("forum.iframe.embed")?(console.log("[Iframe扩展] 添加嵌入按钮"),e.add("iframe",j.a.component({icon:"fas fa-external-link-alt",onclick:function(){console.log("[Iframe扩展] 按钮点击，打开模态框"),a.a.modal.show(new v)},children:a.a.translator.trans("flarum-iframe.forum.composer.embed_iframe_button")}))):console.log("[Iframe扩展] 用户无权限，不显示按钮")})),console.log("[Iframe扩展] 初始化完成")}))}]);
//# sourceMappingURL=forum.js.map